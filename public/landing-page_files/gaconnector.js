var gaconnector={track:function(e){for(cookieName in e){if("lc_"===cookieName.substring(0,3))if(fc_cookieName=cookieName.replace("lc_","fc_"),""===this.getCookie(fc_cookieName))e[fc_cookieName]=e[cookieName],this.setCookie(fc_cookieName,e[cookieName]);else if("(direct)"==e.lc_source)continue;this.setCookie(cookieName,e[cookieName])}var t=this.getCookie("all_traffic_sources");for(""!=t&&(t+=", "),t+=e.lc_source+"/"+e.lc_medium;t.length>1024;)t=t.replace(/^[^,]*, /,"");this.setCookie("all_traffic_sources",t),e.all_traffic_sources=t,e.GA_Client_ID=this.getCookie("GA_Client_ID"),this.cookieValues=e,this.callback(this.getCookieValues()),this.cookiesReceived=!0},getTopDomain:function(e){var t=/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{2,}|[-\w]+\.[-\w]{2})$/i,o=e.split("/")[2],i=t.exec(o);if("object"==typeof i&&i instanceof Array&&i.length>0)return i[0]},getCookie:function(e,t){t||(e="gaconnector_"+e);for(var o=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var c=i[n];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(o))return c.substring(o.length,c.length)}return""},setCookie:function(e,t,o){e="gaconnector_"+e,o=o||157248e5;var i=new Date;i.setTime(i.getTime()+o);var n="expires="+i.toGMTString();t=t.replace(/\|{2,}/g,"|").replace(/^\|/,""),t=t.replace(";",""),document.cookie=e+"="+t+"; "+n+";domain="+this.cookieDomain+";path=/"},timeCounter:Date.now(),trackTimeOnWebsite:function(){setInterval(this.updateTimeCookie,1e3)},updateTimeCookie:function(){var e=Date.now()-gaconnector.timeCounter;gaconnector.timeCounter=Date.now();var t=gaconnector.getCookie("time_passed");""==t&&(t="0");var o=e+parseInt(t);gaconnector.setCookie("time_passed",o.toString())},addPageVisit:function(){for(var e=this.getCookie("pages_visited_list"),t=e.split("|"),o=window.location.pathname,i=!1,n=0;n<t.length;n++)t[n]==o&&(i=!0);i||t.push(o),e=t.join("|"),this.setCookie("pages_visited_list",e)},incrementVisits:function(){var e,t=this.getCookie("page_visits");e=""==t?1:parseInt(t)+1,this.setCookie("page_visits",e.toString())},getCID:function(){var e=gaconnector.getCookie("_ga",!0),t=window[window.GoogleAnalyticsObject];if(void 0!==t&&void 0!==t.getAll){return t.getAll()[0].get("clientId")}if("string"==typeof e&&e.length>0){var o=e.split(".");return o.slice(o.length-2,o.length).join(".")}},cloneCID:function(e){var t=gaconnector.getCID();void 0===t?setTimeout(function(){gaconnector.cloneCID(e)},500):(gaconnector.setCookie("GA_Client_ID",t),e())},callback:function(e){},cookiesReceived:!1,setCallback:function(e){if(this.cookiesReceived||this.internal){e(this.getCookieValues())}else this.callback=e},isInternalReferrer:function(e,t){return""!==t&&void 0!==t&&this.getTopDomain(t)===this.getTopDomain(e)},internal:!1,addRemoteScript:function(){if(this.isInternalReferrer(window.location.href,document.referrer)){internal=!0;var e=this.getCookieValues();this.callback(e)}else{internal=!1;var t=document.createElement("script");t.setAttribute("data-cfasync","false");var o,i="https://tracker.gaconnector.com/gaconnector-server.js"+document.location.search;o=""==document.location.search?"?":"&",i+=o+"referer="+encodeURIComponent(document.referrer),t.src=i,document.getElementsByTagName("head")[0].appendChild(t)}},getCookieValues:function(){for(var e={},t=document.cookie.split("; "),o=0;o<t.length;o++){var i=t[o].split("=")[0],n=t[o].split("=").slice(1).join("=");if(i.length>12&&"gaconnector_"==i.substring(0,12)){e[i.replace("gaconnector_","")]=n}}return e},start:function(){this.internal=this.isInternalReferrer(window.location.href,document.referrer),this.cookieDomain=this.getTopDomain(window.location.href),this.cloneCID(function(){}),this.trackTimeOnWebsite(),this.addPageVisit(),this.incrementVisits(),this.addRemoteScript()}};gaconnector.start();